<%= content_tag :div,
  data: {
    target: "tab-group",
    index: index,
    controller: "tabs",
    tabs_view_value: view,
    tabs_group_id_value: group.id,
    tabs_active_tab_value: active_tab_title,
    tabs_resource_name_value: resource.underscore_name
  } do %>
  <% visible_tabs.each_with_index do |tab, index| %>
    <%= content_tag :div, **args(tab) do %>
      <% if group.title.present? || group.description.present? %>
        <%= render ui.panel_header(title: group.title, description: group.description) %>
      <% end %>

        <%= render Avo::UI::Tabs::TabsComponent.new do %>
          <% visible_tabs.each do |tab_item| %>
            <%= render Avo::UI::Tabs::TabComponent.new(
              label: tab_item.title,
              active: tab_active?(tab_item, tab),
              href: tab_path(tab_item),
              title: tab_item.description,
              data: tab_data(tab_item, tab)
            ) %>
          <% end %>
        <% end %>

        <% if !tab.is_empty? %>
          <% if tab.lazy_load && view.display? %>
            <%= turbo_frame_tag tab.turbo_frame_id(parent: group), **frame_args(tab) do %>
              <% if is_not_loaded?(tab) %>
                <%= render Avo::LoadingComponent.new(title: tab.title) %>
              <% else %>
                <%= render Avo::TabContentComponent.new tab:, resource:, index:, form:, view: %>
              <% end %>
            <% end %>
          <% else %>
            <%= render Avo::TabContentComponent.new tab:, resource:, index:, form:, view: %>
          <% end %>
        <% end %>
    <% end %>
  <% end %>
<% end %>
