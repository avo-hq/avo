<%
# TODO: extract these somewhere else

def resource_for(record)
  klass = Avo.resource_manager.get_resource_by_model_class(record.class)
  klass.new(record: record)
end

def record_title(record)
  resource_for(record).record_title
end

def record_path(record)
  resource_for(record).record_path
end
%>

<div class="p-6">
  <dl>
    <dt>Filename:</dt>
    <dd><%= @blob.filename %></dd>
  </dl>
  <dl>
    <dt>Key:</dt>
    <dd><%= @blob.key %></dd>
  </dl>
  <dl>
    <dt>Content type:</dt>
    <dd><%= @blob.content_type %></dd>
  </dl>
  <dl>
    <dt>Size:</dt>
      <dd><%= number_to_human_size(@blob.byte_size) %></dd>
  </dl>
  <dl>
    <dt>Service name:</dt>
    <dd><%= @blob.service_name %></dd>
  </dl>
  <dl>
    <dt>Created at:</dt>
    <dd><%= @blob.created_at %></dd>
  </dl>
  <dl>
    <% if @blob.attachments.present? %>
      <dt>Attached to:</dt>
      <dd>
        <% @blob.attachments.each do |attachment| %>
          <%= link_to record_title(attachment.record), record_path(attachment.record) %>
        <% end %>
      </dd>
    <% end %>
  </dl>
  <dl>
    <dt>Type:</dt>
    <dd><%= @blob.filename %></dd>
  </dl>
  <dl>
    <dt>Metadata:</dt>
    <dd class="block">
      <% @blob.metadata.each do |key, value| %>
        <div class="block">
          <code><%= key %>: <%= value %></code>
        </div>
      <% end %>
    </dd>
  </dl>
</div>
