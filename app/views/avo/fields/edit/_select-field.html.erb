<%
  if field[:options].present?
    if field[:display_with_value]
      initial_value = field[:options][field[:value]]
      options = field[:options].invert
      options.each {|key, value| options[key] = key }
    else
      options = field[:options]
      initial_value = options[field[:value]]
    end
  else
    options = {}
    initial_value = field[:value] if field[:value].present?
    options[initial_value] = initial_value if field[:value].present?
  end
%>

<%= edit_field_wrapper field: field, index: index, form: form, displayed_in_modal: displayed_in_modal do %>
  <%= form.select field[:id], options, { selected: initial_value, prompt: field[:placeholder] }, {
      class: input_classes('select-input w-full', has_error: (@model.present? and @model.errors.include?(field[:id]))),
      disabled: field[:readonly],
      value: @model.present? ? @model[field[:id]] : field[:value] } %>
<% end %>
